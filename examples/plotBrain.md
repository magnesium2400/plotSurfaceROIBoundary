
# plotBrain Wrapper for plotting multiple views using PLOTBRAIN
    
    
# Contents
   - Dependencies
   - Syntax
   - Description
   - Examples
   - Input Arguments
   - Name-Value Arguments
   - Output Arguments
   - See also
   - Authors
   - TODO
   

Plots multiple brain views/multiple hemispheres/multiple maps.
   

![](../IMAGES/plotBrain_1.svg)
   

![](../IMAGES/plotBrain_2.svg)
   

![](../IMAGES/plotBrain_3.svg)
   
# Dependencies

```matlab:Code(Display)
plotSurfaceROIBoundary (Stuart Oldham):
https://github.com/StuartJO/plotSurfaceROIBoundary or
https://github.com/StuartJO/BrainSurfaceAnimation
```

    
# Syntax

```matlab:Code(Display)
plotBrain(verts, faces, rois, data)
plotBrain(surface, rois, data)
```


```matlab:Code(Display)
plotBrain('lh', {verts, faces, rois, data})
plotBrain('rh', {verts, faces, rois, data})
plotBrain('lh', {verts, faces, rois, data}, 'rh', {verts, faces, rois, data})
plotBrain(___, {surface, rois, data})
```


```matlab:Code(Display)
plotBrain(___, Name, Value)
patches = plotBrain(___)
[patches, boundaries] = plotBrain(___)
[patches, boundaries, outerTiledLayout] = plotBrain(___)
[patches, boundaries, outerTiledLayout, innerTiledLayouts] = plotBrain(___)
```

# Description

`plotBrain(verts, faces, rois, data)` plots the patch object with coordinates given by `verts` and `faces`, and coloured according to `rois` and `data`. Left/right hemisphere will be deduced based on the×coordinates of `verts`.
   

`plotBrain(surface, rois, data)` plots the patch object given by the struct `surface`, and coloured according to `rois` and `data`.
   

`plotBrain('lh', {verts, faces, rois, data})` plots the surface of the left hemisphere, based on the data presented in the cell array that follows. This cell array should contain the data used to generate indivual plots.
   

`plotBrain('rh', {verts, faces, rois, data})` does the same as the above for the right hemisphere.
   

`plotBrain('lh', {verts, faces, rois, data}, 'rh', {verts, faces, rois, data})` plots both the left and right hemisphere, as above.
   

`plotBrain(_, {surface, rois, data})` does the same as the above for the patch object given by struct `surface`.
   

`plotBrain(_, Name, Value)` specifies additional parameters for plotting.
   

`patches = plotBrain(_)` returns the patch objects generated by plotSurfaceROIBoundary. You can use this syntax with any of the input argument combinations in the previous syntaxes.
   

`[patches, boundaries] = plotBrain(_)` also returns the boundary plots generated by plotSurfaceROIBoundary. You can use this syntax with any of the input argument combinations in the previous syntaxes.
   

`[patches, boundaries, outerTiledLayout] = plotBrain(_)` also returns the (outer) tiledlayout in which the surfaces are plotted. You can use this syntax with any of the input argument combinations in the previous syntaxes.
   

`[patches, boundaries, outerTiledLayout, innerTiledLayouts] = plotBrain(_)` also returns the (inner) tiledlayouts when `'groupBy'` is specified. You can use this syntax with any of the input argument combinations in the previous syntaxes.
   
# Examples

```matlab:Code(Display)
figure; plotBrain('lh', {lh_verts, lh_faces, Scha17_parcs.lh_scha100, (1:50).'});
figure('Position', [100 100 1200 420]); plotBrain('rh', {rh_verts, rh_faces, Scha17_parcs.rh_scha100, sum(rh_verts.^2,2)-4000}, 'plotSurface', {'midpoint', @bluewhitered}, 'colorbarOn', true, 'view', {'rl', 'rm'}, 'groupBy', 'data');
figure; [p, b] = plotBrain('lh', {lh_verts, lh_faces, logical(Scha17_parcs.lh_scha100), lh_verts(:,2)}, 'rh', {rh_verts, rh_faces, Scha17_parcs.rh_scha100, (1:50)'.^2}, 'viewOrder', {'rl', 'rm', 'll', 'lm'}, 'tiledLayoutOptions', {2, 2, 'TileSpacing', 'none'});
```

# Input Arguments

```matlab:Code(Display)
verts - xyz coordinates of surface (V×3 matrix)
```


```matlab:Code(Display)
faces - triangulation of surface (F×3 matrix)
```


```matlab:Code(Display)
rois - parcellation of surface (V×1 vector | V×? matrix)
Vector or matrix indicating the ROI ID of each vertex. Use 0 to index
unallocated vertices (e.g. the medial wall). If `rois` is a vector, the same
parcellation will be applied to each column in `data`. Otherwise, the number
of columns in `rois` should match the number of columns in `data` (and one
parcellation will be used for each map).
```


```matlab:Code(Display)
data - brain maps to be plotted (R×1 vector | R×? matrix | V×1 vector | V×? matrix | 1×? cell array )
Data can be specified at either the ROI level (where `size(data, 1) == max(rois)`)
or the vertex level (where `size(data, 1) == size(verts,1)`). If multiple
columns are specified or a cell array is used, each column/cell is treated as
a map, and several brains will be plotted.
```


```matlab:Code(Display)
surface - structure to be plotted with fields 'vertices' and 'faces'
```


```matlab:Code(Display)
lh - data to be passed to plotBrain for left hemisphere (cell array)
This should be a cell array containing the data that would be used to plot a
single view using plotBrain i.e. {verts, faces, rois, data}.
```


```matlab:Code(Display)
rh - data to be passed to plotBrain for right hemisphere (cell array)
This should be a cell array containing the data that would be used to plot a
single view using plotBrain i.e. {verts, faces, rois, data}.
```

    
# Name-Value Arguments

```matlab:Code(Display)
viewOrder - Views to use for each of the inputs (cell array)
The views to use to plot each view of the left and right hemispheres. These
can be in the form of vectors of camera positions, or as the shorthand
'll'/'lm'/'rl'/'rm' (left/right lateral/medial).
```


```matlab:Code(Display)
hemiOrder - Which hemisphere to plot for each view (cell array)
If `viewOrder` is specified using camera angles and both left and right
hemisphere are specified, specify `hemiOrder` as a cell array of `'l'` and
`'r'` to indicate which camera angle applies to which hemiphere.
```


```matlab:Code(Display)
parent - Handle to parent axes (axes handle | tiledlayout handle)
If specified as a tiledlayout handle, use in conjunction with `PARENTHANDLE.Layout.Tile`
to position the current plot within the parent tiledlayout. See also the
examples in the live script. Also consider utilising with `PARENTHANDLE.Layout.TileSpan`.
```


```matlab:Code(Display)
forceTiledlayout - Flag to force 1 map to be generated onto a tiledlayout (false (default) | true)
For simplicity, if generating only 1 map, this will NOT use tiledlayout.
However, if a tiledlayout output is desired (e.g. if parent is a
tiledlayout), this should be set to `true`.
```


```matlab:Code(Display)
tiledlayoutOptions - Options to be passed through when generating outerTiledlayout (cell array)
NOTE that this is unravelled and passed directly through to tiledlayout. By
default, the 'flow' layout is used. See the examples for how this can be
changed.
```


```matlab:Code(Display)
groupBy - Flag to group together brain maps onto sub-tiledlayouts ('none' (default) | 'data' | 'view' )
If set to 'none', each dataset and brainmap will be plotted on its own tile
in outerTiledlayout. Note that innerTiledlayout will not be generated in this
case. If set to 'data', the multiple views of each dataset will be generated
on their own individual tiledlayout (i.e. innerTiledlayout); these will then
be embedded into the outerTiledlayout. A similar process occurs for 'view'.
See also the examples in the live script.
```


```matlab:Code(Display)
tiledlayout2Options - Options to be passed through when generating each innerTiledlayout (cell array)
NOTE that this is unravelled and passed directly through to tiledlayout. By
default, the 'flow' layout is used. See the examples for how this can be
changed.
```


```matlab:Code(Display)
titles - Titles for each group/map (cell array)
There must be one element for each group (if '`groupBy`' is specified)/map.
```


```matlab:Code(Display)
clim - New color limits to apply to all the maps (vector of the form |[cmin max]|)
Specification of `clim` will set `colorscheme` to global.
```


```matlab:Code(Display)
colormap - Colormap for plotting (colormap name | three-column matrix of RGB triples | function handle)
Colormap for the new color scheme, specified as a colormap name, a
three-column matrix of RGB triplets, or a function handle (which may be
useful for diverging/dynamic colormaps). Note that it is difficult to change
the colors of the patch object after generation (due to the functionality of
plotSurfaceROIBoundary): setting the correct colormap when plotBrain is
called is recommended.
```


```matlab:Code(Display)
colorscheme - Flag to use same clims for all brainmaps ('indiv' (default) | 'global')
If set to 'global', the maximum and minimum values from both the left and
right hemispheres will be used to set the color limits for each plot. If
'clim' is specified, those limits will instead be applied to each plot.
```


```matlab:Code(Display)
colorbarOn - Flag to plot colorbar for each map/group (false (default) | true)
If set to true, a colorbar will be plotted for each indidivual map or each
group (if 'groupBy' is specified). This is recommended, as accessing axis
color properties after plotBrain is called can be difficult (due to the
functionality of plotSurfaceROIBoundary).
```


```matlab:Code(Display)
colorbarOptions - Options to use when generating colorbars (cell array)
This is unravelled and passed through directly to COLORBAR. This should
contain optional arguments for modifying the generation of the colorbar.
```


```matlab:Code(Display)
colorbarLocation - Location of colorbar ('east' (default) | string)
```


```matlab:Code(Display)
plotSurfaceROIBoundaryOptions - options to be passed through to plotSurfaceROIBoundary (cell array)
NOTE that this is unravelled and passed through directly to
plotSurfaceROIBoundary. This should contain supplementary arguments to be
passed to plotSurfaceROIBoundary for modifying the generation of the plots,
including the method for separating ROIs. See plotSurfaceROIBoundary for more
information regarding its optional inputs.
```

    
# Output Arguments

```matlab:Code(Display)
p - output from plotSurfaceROIBoundary (cell array)
Cell array containing all the outputs from plotBrain, in order of tile.
```


```matlab:Code(Display)
boundary_plots - output from plotSurfaceROIBoundary (cell array)
Cell array containing all the outputs from plotBrain, in order of tile.
```


```matlab:Code(Display)
outerTiledLayout - tiledlayout of all brain maps (tiledlayout)
This is the tiledlayout in which all the brain maps are embedded.
```


```matlab:Code(Display)
innerTiledLayouts - tiledlayouts of each view/dataset of brain maps (cell array)
If `'groupBy'` is specified, each group is plotted on its own tiledlayout,
within outerTiledlayout. This is the cell array of all of those.
```

    
# See also

```matlab:Code(Display)
plotSurfaceROIBoundary, VIEW, PATCH, TILEDLAYOUT
```

    
# Authors

Mehul Gajwani, Monash University, 2023
   
# TODO

   - consider reviewing color scale for each axis
   - consider adding mechanism to change only the tiledlayout size
   - consider allowing different options to be passed throught for each plot

